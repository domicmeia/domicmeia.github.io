---
layout: post
category: Note
use_math: true
---
> `제주대학교 가상화기술개론` 정리

## Modifiying the container layer

```shell
$ docker volume create sample
```
new data volume을 만들기 위해서 **docker volume create**을 사용한다. sample이라는 volume을 만든다.

```shell
$ docker volume inspect sample
```
data가 host에 어디에 저장되어 있는지 사용하는 command는 **docker volume inspect**을 사용한다.

```shell
$ docker run -it --rm --privileged --pid=host fundamentalsofdocker/nsenter
```
filesystem 접근 권한을 갖기 위해 privileged모드로 run한다. **-pid=host**는 container가 host에 접근 가능함을 의미한다. **nsenter** 커맨드로 host의 Linux namespace에 진입한다.

## Mounting a volume

```shell
$ docker container run --name test -it -v sample:/data alpine /bin/sh
```
data 폴더에 sample을 마운팅한다. 폴더가 없으면 만들어 내고, 이미지가 없으면 다운한다.

```shell
$ cd /data / # echo "Some data" > data.txt
```
data 폴더에 진입해서 Some data라고 적혀저 있는 data.txt 파일을 만든다.

```shell
$ docker run -it --rm --privileged --pid=host fundamentalsofdocekr/nsenter
/ # cd (해당 경로)
/ # ls -l
```
잘 만들어졌는지 확인한다.

```shell
$ docker container rm -f $(docker container ls -aq)
```
run 중인 모든 container를 삭제한다.

```shell
$ docker volume rm sample
```
방금 만들었던 volume을 삭제한다.

## Sharing data between containers

원래는 하나가 write 할 때, 다른 얘들은 read only인데 무슨 문제인지 동시 write가 됨. wsl2로 돌렸을 때, container 한 개 돌리고 write 한다음, 다음 container 돌리면 이전 container가 stop됨.